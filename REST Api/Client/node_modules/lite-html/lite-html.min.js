/**
 * @license
 * MIT License
 *
 * Copyright (c) 2018 Goffert van Gool
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

const e=Math.random().toString(36).slice(2).padStart(10,"0"),t=`font-family:${e}`,r=`font-family: ${e};`,s=`comment-${e}`,n=`node-${e}`,i=`${n}" ${n} `,a=e=>"string"==typeof e||"number"==typeof e||"boolean"==typeof e,o=e=>Array.isArray(e)||e[Symbol.iterator],h={},l={},d={};class c{constructor({node:e,parent:t,before:r,after:s}){this.node=e||l,this.value=h,this.parentNode=t||e&&e.parentNode,this.beforeNode=r||e&&e.previousSibling,this.afterNode=s||e&&e.nextSibling}render(e){e!==h&&(null==e?this.clear():a(e)?this._renderText(e):e instanceof I?this._renderTemplateResult(e):o(e)?this._renderIterable(e):e instanceof Node?this._renderNode(e):void 0!==e.then?this._renderPromise(e):(e=String(e),this._renderText(e)),this.value=e)}_renderText(e){this.value!==e&&(3===this.node.nodeType?this.node.textContent=e:this._renderNode(document.createTextNode(e)))}_renderTemplateResult(e){this.templateInstances=this.templateInstances||new Map;let t=this.templateInstances.get(e.template);t||(t=new B(e.template,this.parentNode,this.beforeNode,this.afterNode),this.templateInstances.set(e.template,t)),this.node!==t.fragment&&(this.clear(),this.parentNode.insertBefore(t.fragment,this.afterNode),this.node=t.fragment),t.render(e.values)}_renderIterable(e){this.node!==d&&(this.clear(),this.node=d,this.iterableParts?this.iterableParts.length=0:this.iterableParts=[]);let t,r=0,s=this.afterNode?this.afterNode.previousSibling:this.parentNode.lastChild;const n=this.parentNode;for(const i of e){let e=this.iterableParts[r];void 0===e&&(t=document.createTextNode(""),this.parentNode.insertBefore(t,this.afterNode),e=new c({before:s,after:t,parent:n}),this.iterableParts.push(e),s=t),e.render(i),r++}if(0===r)p(this.parentNode,this.beforeNode,this.afterNode);else if(r<this.iterableParts.length){const e=this.iterableParts[r-1];p(this.parentNode,e.afterNode,this.afterNode)}this.iterableParts.length=r}_renderNode(e){this.node!==e&&(this.clear(),this.parentNode.insertBefore(e,this.afterNode),this.node=e)}_renderPromise(e){this.value!==e&&this.promise!==e&&(this.clear(),this.promise=e,this.value=e,e.then(t=>{this.value===e&&this.render(t)}))}clear(){p(this.parentNode,this.beforeNode,this.afterNode,this.node),this.node=l}}const p=(e,t,r,s)=>{let n;if(null!==(n=null==t?e.firstChild:t&&t.nextSibling)){let t,i;for(n=n||e.firstChild,t=s instanceof DocumentFragment?()=>s.appendChild(n):()=>e.removeChild(n);n!=r;)i=n.nextSibling,t(),n=i}};class u{constructor({node:e}){this.node=e}render(e){this.node.textContent=e}}class m{constructor({node:e,attribute:t}){switch(this.node=e,t[0]){case".":this.render=this._renderProperty;case"?":this.render=this.render||this._renderBoolean;case"@":this.render=this.render||this._renderEvent,this.node.removeAttribute(t),this.name=t.slice(1);break;default:this.render=this._renderAttribute,this.name=t}}_renderProperty(e){this.node[this.name]=e}_renderBoolean(e){this.value!==!!e&&(e?this.node.setAttribute(this.name,""):this.node.removeAttribute(this.name),this.value=e)}_renderEvent(e){this.value!==e&&(this.node.removeEventListener(this.name,this.value),this.node.addEventListener(this.name,e),this.value=e)}_renderAttribute(e){e!==this.value&&(this.node.setAttribute(this.name,e),this.value=e)}}const f=/[ \x09\x0a\x0c\x0d]([^\0-\x1F\x7F-\x9F \x09\x0a\x0c\x0d"'>=\/]+)[ \x09\x0a\x0c\x0d]*=$/,b=[].filter,x=(e,a)=>{let o=[];const h=(a,l)=>{if(8===a.nodeType)a.nodeValue===s?o.push({type:u,path:l}):a.nodeValue===i&&o.push({type:c,path:l});else{if(1===a.nodeType){if(a.hasAttribute(n))throw new Error("The '>' character is not allowed in attribute literals. Replace with '&gt;'");if(a.hasAttribute(t)){a.removeAttribute(t);let s=b.call(a.attributes,e=>e.value===t).length;a.getAttribute("style")===r&&(s+=1);for(let t=0;t<s;t++){const t=f.exec(e[o.length])[1];o.push({type:m,path:l,attribute:t})}}}const s=a.childNodes,i=s.length;for(let e=0;e<i;e++)h(s[e],l.concat([e]))}};if(h(a.content,[]),o.length<e.length-1)throw new Error("Double attribute assignments are not allowed: '<div a=${0} a=${0}>'");return o},g=`${t} ${t}`,N=`--\x3e\x3c!--${s}--\x3e\x3c!-- `,v=`\x3c!--${i}--\x3e`,_=Symbol("attributeContext"),y=Symbol("commentContext"),w=Symbol("nodeContext"),S=Symbol("unchangedContext"),P=new Map;P.set(_,g),P.set(y,N),P.set(w,v);const $=e=>{const t=e.lastIndexOf("\x3c!--"),r=e.indexOf("--\x3e",t+1)>-1;let s;if(t>-1&&!r)s=y;else{const t=e.lastIndexOf(">");s=e.indexOf("<",t+1)>-1?_:t>-1?w:S}return{commentClosed:r,type:s}},C=e=>{const t=[],r=e.length-1;let s=w;for(let n=0;n<r;n++){const r=e[n],i=$(r);if(s===y&&!i.commentClosed||i.type===S||(s=i.type),s===_&&"="!==r.slice(-1))throw new Error("Only bare attribute parts are allowed: `<div a=${0}>`");t.push(r),t.push(P.get(s))}return t.push(e[r]),t.join("")},A=e=>{const t=document.createElement("template");return t.innerHTML=C(e),t},T=new Map;class E{constructor(e){this.strings=e,this.element=A(e),this.parts=x(e,this.element)}}class I{constructor(e,t){this.strings=e,this.values=t,this._template=void 0}get template(){if(this._template)return this._template;let e=T.get(this.strings);return e||(e=new E(this.strings),T.set(this.strings,e)),this._template=e,e}}class B{constructor(e,t,r,s){this.template=e,this.fragment=e.element.content.cloneNode(!0);const n=this.template.parts.map(e=>{let n=this.fragment;return e.path.forEach(e=>{n=n.childNodes[e]}),e.node=n,e.type===c&&(1===e.path.length?(e.parent=t,e.before=n.previousSibling||r,e.after=n.nextSibling||s):e.parent=n.parentNode),e});this.parts=n.map(e=>new e.type(e))}render(e){this.parts.map((t,r)=>t.render(e[r]))}}const M=(e,...t)=>new I(e,t),O=(e,t)=>{let r=t.__nodePart;r||(r=new c({parent:t}),t.__nodePart=r),r.render(e)};export{M as html,O as render,h as noChange};
//# sourceMappingURL=lite-html.min.js.map
